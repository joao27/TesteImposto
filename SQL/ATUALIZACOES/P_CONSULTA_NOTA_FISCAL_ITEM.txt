USE [Teste]
GO
IF OBJECT_ID('dbo.P_CONSULTA_NOTA_FISCAL_ITEM') IS NOT NULL
BEGIN
    DROP PROCEDURE dbo.P_CONSULTA_NOTA_FISCAL_ITEM
    IF OBJECT_ID('dbo.P_CONSULTA_NOTA_FISCAL_ITEM') IS NOT NULL
        PRINT '<<< FALHA APAGANDO A PROCEDURE dbo.P_CONSULTA_NOTA_FISCAL_ITEM >>>'
    ELSE
        PRINT '<<< PROCEDURE dbo.P_CONSULTA_NOTA_FISCAL_ITEM APAGADA >>>'
END
go
SET QUOTED_IDENTIFIER ON
GO
SET NOCOUNT ON 
GO 
CREATE PROCEDURE dbo.P_CONSULTA_NOTA_FISCAL_ITEM 
(
	@pPage int,
	@pSize int
)
AS
BEGIN
	IF(@pPage < 0) BEGIN SET @pPage = 0 END;

	SELECT 
		CFOP, BASEICMS, VALORICMS, BASEIPI, VALORIPI 
	FROM 
		NOTAFISCALITEM 
	GROUP BY 
		CFOP, BASEICMS, VALORICMS, BASEIPI, VALORIPI
	ORDER BY 
		CFOP 
	OFFSET (@pSize * @pPage) ROWS FETCH NEXT @pSize ROWS ONLY;
END
GO
GRANT EXECUTE ON dbo.P_CONSULTA_NOTA_FISCAL_ITEM TO [public]
GO
IF OBJECT_ID('dbo.P_CONSULTA_NOTA_FISCAL_ITEM') IS NOT NULL
    PRINT '<<< PROCEDURE dbo.P_CONSULTA_NOTA_FISCAL_ITEM CRIADA >>>'
ELSE
    PRINT '<<< FALHA NA CRIACAO DA PROCEDURE dbo.P_CONSULTA_NOTA_FISCAL_ITEM >>>'
GO